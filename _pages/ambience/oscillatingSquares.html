---
layout: none
---

<head>
  <title>Oscillating Squares even though They're not Squares</title>
  {% include favicon.html %}
</head>

<style>
  canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
</style>

<canvas id="canv"></canvas>

<script>
  var canvas = document.getElementById("canv");
  var ctx = canvas.getContext("2d");
  var count = 10;
  const squares = [];
  var lastTime = Date.now();
  var t = 0;
  var transLen = 5000; // in ms
  var r;

  class Square {
    constructor(width, height, i, j) {
      this.oX = i * width;
      this.oY = j * height;
      this.x = this.oX;
      this.y = this.oY;
      this.width = width;
      this.height = height;
    }
    
    show() {
      ctx.lineWidth = 2;
      ctx.fillStyle = "#7F7F7F2F";
      ctx.strokeStyle = "#00FFCF2F";
      ctx.fillRect(lerp(this.x / 2, this.x, t / transLen), this.y, this.width, this.height); // rethink
      ctx.strokeRect(this.x, this.y, this.width, this.height);
    }
  }

  window.addEventListener("resize", () => {
    clearTimeout(r);
    r = setTimeout(() => {
      resize();
      reset();
    }, 200);
  });

  resize(false);
  reset();

  setInterval(draw, 35); // basically 30 fps

  function draw() {
    t += Date.now() - lastTime;
    // draw
    ctx.fillStyle = "#000000";
    ctx.fillRect(
      0,
      0,
      innerWidth * window.devicePixelRatio,
      innerHeight * devicePixelRatio
    );

    for (let i = 0; i < squares.length; i++) {
      squares[i].show();
    }

    if (t >= transLen) {
      t = 0;
    }

    lastTime = Date.now();
  }

  function resize(d = true) {
    if (window.devicePixelRatio >= 1) {
      canvas.height = window.innerHeight * window.devicePixelRatio;
      canvas.width = window.innerWidth * window.devicePixelRatio;
    }

    if (d) draw();
  }

  function reset() {
    let width = (window.innerWidth * window.devicePixelRatio) / count;
    let height = (window.innerHeight * window.devicePixelRatio) / count;

    squares.length = 0;

    for (let i = 0; i < count; i++) {
      for (let j = 0; j < count; j++) {
        squares.push(new Square(width, height, i, j));
      }
    }
  }

  function lerp(a, b, f) {
    return (1 - f) * a + f * b;
  }
</script>
